(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7578a050"],{1:function(t,e){},"1e89":function(t,e,o){"use strict";var a,i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"createPost-container"},[o("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[o("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar "+t.postForm.status}},[o("div",{staticClass:"row-box margin-top"},[o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("发布")]),t._v(" "),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"warning"},on:{click:t.draftForm}},[t._v("保存草稿")])],1)]),t._v(" "),o("div",{staticClass:"createPost-main-container"},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[o("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.postForm.articleTitle,callback:function(e){t.$set(t.postForm,"articleTitle",e)},expression:"postForm.articleTitle"}},[t._v("标题")])],1),t._v(" "),o("div",{staticClass:"postInfo-container"},[o("el-row",[o("el-col",[o("el-form-item",{staticStyle:{"margin-bottom":"60px"}},[o("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.postForm.articleSubTitle,callback:function(e){t.$set(t.postForm,"articleSubTitle",e)},expression:"postForm.articleSubTitle"}},[t._v("副标题")])],1)],1)],1),t._v(" "),o("el-row",{staticStyle:{marginTop:"'40px'"}},[o("el-col",{attrs:{span:8}},[o("el-form-item",{staticClass:"postInfo-container-item",staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"75px",label:"作者来源:"}},[o("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入作者"},model:{value:t.postForm.author,callback:function(e){t.$set(t.postForm,"author",e)},expression:"postForm.author"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"postInfo-container-item",staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"100px",label:"发布时间:"}},[o("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期和时间"},model:{value:t.postForm.displayTime,callback:function(e){t.$set(t.postForm,"displayTime",e)},expression:"postForm.displayTime"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"90px",label:"首页显示:"}},[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.postForm.inMainPage,callback:function(e){t.$set(t.postForm,"inMainPage",e)},expression:"postForm.inMainPage"}})],1)],1)],1)],1)],1)],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{label:"摘要:"}},[o("el-row",[o("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入文章摘要"},model:{value:t.postForm.articleSummary,callback:function(e){t.$set(t.postForm,"articleSummary",e)},expression:"postForm.articleSummary"}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.contentShortLength)+"字")])],1)],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"picSrc",label:"封面图片"}},[o("Upload",{model:{value:t.postForm.picSrc,callback:function(e){t.$set(t.postForm,"picSrc",e)},expression:"postForm.picSrc"}}),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"78px",label:"加入轮播:"}},[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.postForm.inScroll,callback:function(e){t.$set(t.postForm,"inScroll",e)},expression:"postForm.inScroll"}})],1)],1)],1),t._v(" "),o("div",[o("el-form-item",{staticClass:"postInfo-container-item",staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"75px",label:"视频地址:"}},[o("el-col",{attrs:{span:18}},[o("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入视频地址"},model:{value:t.postForm.videoSrc,callback:function(e){t.$set(t.postForm,"videoSrc",e)},expression:"postForm.videoSrc"}})],1)],1)],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"30px","margin-top":"20px"},attrs:{prop:"content"}},[o("Tinymce",{ref:"editor",attrs:{height:600},model:{value:t.postForm.htmlContent,callback:function(e){t.$set(t.postForm,"htmlContent",e)},expression:"postForm.htmlContent"}})],1)],1)],1)],1)},r=[],s=o("bd86"),l=o("db72"),n=o("8256"),c=o("70a2"),m=o("1aba"),p=o("b804"),u=o("2423"),d=o("2f62"),f=o("4fd1"),h={status:"draft",articleTitle:"",articleSubTitle:"",articleSummary:"",fromTitle:"",picSrc:"",display_time:void 0,inMainPage:!1,id:void 0,inScroll:!1,videoSrc:","},v=(a={name:"ArticleDetail",components:{Tinymce:n["a"],MDinput:m["a"],Upload:c["a"],Sticky:p["a"],VideoPlayerComponent:f["a"]},props:{isEdit:{type:Boolean,default:!1},articleType:{type:String,default:""}},computed:{picSrc:function(){return this.postForm.picSrc}},data:function(){var t=this,e=function(e,o,a){if(a(),""===o){var i="";"title"===e.field&&(i="标题"),t.$message({message:i+"为必传项",type:"error"}),a(new Error(i+"为必传项"))}else a()},o=function(e,o,a){o?validURL(o)?a():(t.$message({message:"外链url填写不正确",type:"error"}),a(new Error("外链url填写不正确"))):a()};return{postForm:Object.assign({},h),loading:!1,userListOptions:[],rules:{picSrc:[{validator:e}],title:[{validator:e}],content:[{validator:e}],source_uri:[{validator:o,trigger:"blur"}]},tempRoute:{}}}},Object(s["a"])(a,"computed",{visitViews:function(){return this.$store.state.tagViewData.visitViews},contentShortLength:function(){return this.postForm.articleSummary.length},displayTime:{get:function(){return+new Date(this.postForm.display_time)},set:function(t){this.postForm.display_time=new Date(t)}}}),Object(s["a"])(a,"beforeMount",function(){var t=this.$route.query;if(""===this.articleType&&void 0!==t.articleType&&(this.articleType=t.articleType),this.isEdit){var e=this.$route.params&&this.$route.params.id;this.fetchData(e,this.articleType)}else this.postForm=Object.assign({},h);this.tempRoute=Object.assign({},this.$route)}),Object(s["a"])(a,"methods",Object(l["a"])({},Object(d["c"])("tagViewData",["DEL_VIEW","DEL_CACHED"]),{fetchData:function(t,e){var o=this;Object(u["a"])(t,e).then(function(t){console.log("response data",t.data),o.postForm=t.data,console.log("post form",o.postForm),o.setTagsViewTitle(),o.setPageTitle()}).catch(function(t){console.log(t)})},setTagsViewTitle:function(){var t="编辑-",e={title:"".concat(t,"-").concat(this.postForm.articleTitle.substr(0,4),"..."),path:this.tempRoute.fullPath};this.$store.dispatch("tagViewData/updateVisitedView",e)},setPageTitle:function(){var t="Edit Article";document.title="".concat(t," - ").concat(this.postForm.id)},closeSelectedTag:function(t){this.DEL_VIEW(t),this.DEL_CACHED(t);var e=this.visitViews.slice(-1)[0];e?this.$router.push(e.path):this.$router.push("/")},submitForm:function(){var t=this;console.log(this.postForm),this.postForm.articleType=this.articleType,this.postForm.articleStatus="published",this.$refs.postForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log("=====submit=====",t.postForm),Object(u["d"])(t.postForm).then(function(){t.loading=!0,t.$notify({title:"成功",message:"发布文章成功",type:"success",duration:2e3}),t.loading=!1,t.closeSelectedTag(t.$route.path)})})},draftForm:function(){var t=this;console.log(this.postForm),this.postForm.articleType=this.articleType,this.postForm.articleStatus="draft",this.$refs.postForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log("=====submit=====",t.postForm),Object(u["d"])(t.postForm).then(function(){t.loading=!0,t.$notify({title:"成功",message:"保存草稿成功",type:"success",duration:2e3}),t.loading=!1,t.closeSelectedTag(t.$route.path)})})}})),a),b=v,g=(o("a047"),o("2877")),F=Object(g["a"])(b,i,r,!1,null,"4ba4eedb",null);e["a"]=F.exports},2423:function(t,e,o){"use strict";o.d(e,"c",function(){return i}),o.d(e,"a",function(){return r}),o.d(e,"d",function(){return s}),o.d(e,"b",function(){return l});var a=o("b775");function i(){return Object(a["a"])({url:"/scrollImg/list",method:"get"})}function r(t,e){return Object(a["a"])({url:"/article/get",method:"get",params:{id:t,articleType:e}})}function s(t){return Object(a["a"])({url:"/article/detail",method:"post",data:t})}function l(t){return Object(a["a"])({url:"/article/list",method:"post",data:t})}},"3b52":function(t,e,o){},"964f":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("article-detail",{attrs:{"is-edit":!0}})},i=[],r=o("1e89"),s={name:"EditForm",components:{ArticleDetail:r["a"]}},l=s,n=o("2877"),c=Object(n["a"])(l,a,i,!1,null,null,null);e["default"]=c.exports},a047:function(t,e,o){"use strict";var a=o("3b52"),i=o.n(a);i.a}}]);